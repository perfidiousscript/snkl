/*! snkl 2015-12-04 */
snklApp.controller("AboutController",["$scope",function(a){console.log("This works"),a.thing={text:"About Controller works!"}}]),snklApp.controller("AddController",["$scope",function(a){console.log("This works"),a.thing={text:"Add Controller works!"}}]),snklApp.controller("ContactController",["$scope",function(a){console.log("This works"),a.thing={text:"Contact Controller works!"}}]),snklApp.controller("MainController",["$scope","$http",function(a,b){a.dataArray=[],a.detailData={},b({method:"GET",url:"data/populate"}).success(function(b){a.populateGraph(b)}),a.populateGraph=function(c){var d=d3.select(".showData").append("svg"),e=d3.scale.linear().domain([1915,2015]).range([0,900]),f=d3.scale.linear().domain([0,100]).range([0,900]),g=d3.scale.linear().domain([0,100]).range([0,500]),h=d3.svg.axis().scale(e).orient("bottom");d.attr("width",900),d.attr("height",500);var i,j=d.selectAll("g").data(c).enter().append("g").call(h);j.append("rect").attr("class","author").attr("class",function(a){return"'"+a.id+"'"}).attr("width",function(a){return f(a.last_work-a.first_work)}).attr("height",30).attr("x",function(a){return e((a.last_work-a.first_work)/2+a.first_work)}).attr("y",function(a){return g(a.style)}),j.append("line").attr("y1",function(a){return g(a.style+2)}).attr("y2",function(a){return g(a.style+2)}).attr("x1",function(a){return e(a.birth_year)}).attr("x2",function(a){return e(a.death_year)}).style({stroke:"black","stroke-width":"8"}),j.append("circle").attr("cy",function(a){return g(a.style)}).attr("cx",function(a){return e(a.last_work)}).attr("r",7).style("fill","white").style("stroke","black").attr("class","details").text("Details").on("click",function(b){a.details(b)}),j.append("text").attr("x",function(a){return e((a.last_work-a.first_work)/2+a.first_work)}).attr("y",function(a){return g(a.style+3)}).attr("font-size","20px").style("fill","white").text(function(a){return a.author_name}),j.selectAll("rect").on("click",function(c,d){null!=i&&d3.select(i).select("rect").attr("class","null"),i=this,d3.select(i).select("rect").attr("class","selected"),b({method:"POST",url:"data/connections",data:c}).success(function(b){a.connections(b)})}),a.connections=function(a){var b=d3.scale.ordinal().domain([1,2,3]).range(["red","green","blue"]),c=d3.select("svg").selectAll("rect");d3.select("svg").selectAll("line").remove();for(var d=0;d<a.length;d++){var e={"stroke-width":6,stroke:b(parseInt(a[d].type))};j.append("line").attr("x1",c.filter(function(b){return b.id==a[d].author_1}).attr("x")).attr("y1",c.filter(function(b){return b.id==a[d].author_1}).attr("y")).attr("x2",c.filter(function(b){return b.id==a[d].author_2}).attr("x")).attr("y2",c.filter(function(b){return b.id==a[d].author_2}).attr("y")).style(e)}},a.details=function(c){b({method:"POST",url:"data/details",data:c}).success(function(b){a.detailData=b,console.log("Here is detailData:",a.detailData)})}}}]);